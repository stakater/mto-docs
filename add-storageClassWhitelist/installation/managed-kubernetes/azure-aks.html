
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.stakater.com/mto/add-storageClassWhitelist/installation/managed-kubernetes/azure-aks.html">
      
      
        <link rel="prev" href="overview.html">
      
      
        <link rel="next" href="aws-eks.html">
      
      
      <link rel="icon" href="../../assets/images/favicon.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.44">
    
    
      
        <title>Multi Tenant Operator in Microsoft Azure Kubernetes Service - Multi Tenant Operator</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Space+Grotesk:300,300i,400,400i,700,700i%7CSpace+Grotesk:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Space Grotesk";--md-code-font:"Space Grotesk"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-TTH1YYW5TX"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-TTH1YYW5TX",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-TTH1YYW5TX",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#multi-tenant-operator-in-microsoft-azure-kubernetes-service" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
This documentation comes from a pull request build and is unreleased, it is only used for review.
<a href="https://docs.stakater.com/mto/">
  <strong>Click here to go to the released documentation.</strong>
</a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    


  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="Multi Tenant Operator" class="md-header__button md-logo" aria-label="Multi Tenant Operator" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Multi Tenant Operator
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Multi Tenant Operator in Microsoft Azure Kubernetes Service
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 2c-1.05 0-2.05.16-3 .46 4.06 1.27 7 5.04 7 9.54s-2.94 8.27-7 9.54c.95.3 1.95.46 3 .46a10 10 0 0 0 10-10A10 10 0 0 0 9 2"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/stakater/mto-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>

    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="Multi Tenant Operator" class="md-nav__button md-logo" aria-label="Multi Tenant Operator" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Multi Tenant Operator
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/stakater/mto-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../openshift.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    On OpenShift
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    On Kubernetes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../helm-values.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Helm Chart Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" checked>
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Managed Kubernetes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Managed Kubernetes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="overview.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Multi Tenant Operator in Microsoft Azure Kubernetes Service
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="azure-aks.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Multi Tenant Operator in Microsoft Azure Kubernetes Service
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-an-admin-group" class="md-nav__link">
    <span class="md-ellipsis">
      Create an Admin Group
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-an-aks-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Create an AKS Cluster
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create an AKS Cluster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-test-groups-in-entra-id" class="md-nav__link">
    <span class="md-ellipsis">
      Create test groups in Entra ID
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-test-users-in-entra-id" class="md-nav__link">
    <span class="md-ellipsis">
      Create test users in Entra ID
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-cert-manager-and-mto" class="md-nav__link">
    <span class="md-ellipsis">
      Installing Cert Manager and MTO
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installing Cert Manager and MTO">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-cert-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Install Cert Manager
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-mto-using-helm" class="md-nav__link">
    <span class="md-ellipsis">
      Install MTO using Helm
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#users-interaction-with-the-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Users Interaction with the Cluster
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Users Interaction with the Cluster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#appdev-group" class="md-nav__link">
    <span class="md-ellipsis">
      AppDev group
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opssre-group" class="md-nav__link">
    <span class="md-ellipsis">
      OpsSre group
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleanup-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Cleanup Resources
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="aws-eks.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi Tenant Operator in Amazon Elastic Kubernetes Service
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pricing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pricing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Configuring Tenants
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Configuring Tenants
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tenant/create-tenant.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating a Tenant
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tenant/create-sandbox.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create Sandbox Namespaces for Tenant Users
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tenant/creating-namespaces.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating Namespaces through Tenant Custom Resource
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tenant/assigning-metadata.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assigning Metadata in Tenant Custom Resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tenant/tenant-hibernation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hibernating a Tenant
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tenant/deleting-tenant.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deleting a Tenant While Preserving Resources
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Interacting with Templates
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Interacting with Templates
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/distributing-resources/copying-resources.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Copying Secrets and Configmaps across Tenant Namespaces via TGI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/distributing-resources/distributing-manifests.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distributing Resources in Namespaces
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    How-to Guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            How-to Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    RBAC
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            RBAC
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/custom-roles.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changing the default access level for tenant owners
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/extend-default-roles.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extending the default access level for tenant members
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Resource Distribution
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Resource Distribution
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/configuring-multitenant-network-isolation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuring Multi-Tenant Isolation with Network Policy Template
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/deploying-templates.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distributing Resources in Namespaces
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/resource-sync-by-tgi.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sync Resources Deployed by TemplateGroupInstance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/distributing-secrets-using-sealed-secret-template.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distributing Secrets Using Sealed Secrets Template
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/deploying-private-helm-charts.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deploying Private Helm Chart to Multiple Namespaces
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/copying-resources.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Propagate Secrets from Parent to Descendant namespaces
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Console
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Console
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/keycloak.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setting Up User Access in Keycloak for MTO Console
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/custom-metrics.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom Metrics Support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/graph-visualization.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graph Visualization on MTO Console
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/hibernation-workflow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hibernation Workflow
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Integrations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            Integrations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/enabling-multi-tenancy-argocd.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enabling Multi-Tenancy in ArgoCD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/enabling-multi-tenancy-vault.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuring Vault in IntegrationConfig
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/enabling-openshift-dev-workspace.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enabling DevWorkspace for Tenant's sandbox in OpenShift
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/mattermost.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating Mattermost Teams for your tenant
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/integrating-external-keycloak.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integrating External Keycloak
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/integrating-vault.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integrating Vault and Keycloak with Microsoft Entra ID
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Offboarding
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            Offboarding
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/offboarding/uninstalling.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Uninstall via OperatorHub UI on OpenShift
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Explanation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Explanation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/logs-metrics.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metrics and Logs Documentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/template.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Understanding and Utilizing Template
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/console.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MTO Console
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/templated-metadata-values.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Templated values in Labels and Annotations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/multi-tenancy-vault.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi-Tenancy in Vault
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CRDs API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            CRDs API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crds-api-reference/quota.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quota
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crds-api-reference/tenant.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tenant
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crds-api-reference/integration-config.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integration Config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crds-api-reference/resource-supervisor.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resource Supervisor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crds-api-reference/extensions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extensions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crds-api-reference/template.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Template
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crds-api-reference/template-instance.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TemplateInstance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crds-api-reference/template-group-instance.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TemplateGroupInstance
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../eula.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi Tenant Operator End User License Agreement
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting Guide
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-an-admin-group" class="md-nav__link">
    <span class="md-ellipsis">
      Create an Admin Group
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-an-aks-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Create an AKS Cluster
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create an AKS Cluster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-test-groups-in-entra-id" class="md-nav__link">
    <span class="md-ellipsis">
      Create test groups in Entra ID
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-test-users-in-entra-id" class="md-nav__link">
    <span class="md-ellipsis">
      Create test users in Entra ID
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-cert-manager-and-mto" class="md-nav__link">
    <span class="md-ellipsis">
      Installing Cert Manager and MTO
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installing Cert Manager and MTO">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-cert-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Install Cert Manager
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-mto-using-helm" class="md-nav__link">
    <span class="md-ellipsis">
      Install MTO using Helm
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#users-interaction-with-the-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Users Interaction with the Cluster
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Users Interaction with the Cluster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#appdev-group" class="md-nav__link">
    <span class="md-ellipsis">
      AppDev group
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opssre-group" class="md-nav__link">
    <span class="md-ellipsis">
      OpsSre group
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleanup-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Cleanup Resources
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="multi-tenant-operator-in-microsoft-azure-kubernetes-service">Multi Tenant Operator in Microsoft Azure Kubernetes Service<a class="headerlink" href="#multi-tenant-operator-in-microsoft-azure-kubernetes-service" title="Permanent link">#</a></h1>
<p>This document covers how to link Multi Tenant Operator with an <a href="https://azure.microsoft.com/en-us/products/kubernetes-service/">AKS (Azure Kubernetes Service)</a> cluster.</p>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">#</a></h2>
<ul>
<li>Make sure Azure CLI version 2.0.61 or later is installed and configured. If you need to install or upgrade, see <a href="https://learn.microsoft.com/en-us/cli/azure/install-azure-cli">Install Azure CLI</a>. To find the version, run:
<code>az --version</code></li>
<li>You need kubectl as well, with a minimum version of 1.18.3. If you need to install, see <a href="https://kubernetes.io/docs/tasks/tools/#kubectl">Install kubectl</a>.</li>
<li>To install MTO, you need Helm CLI as well. Visit <a href="https://helm.sh/docs/intro/install/">Installing Helm</a> to get Helm CLI</li>
<li>You need to have a user in <a href="https://portal.azure.com/signin/index/">Azure Portal</a>, which we will use as the administrator for creating clusters, users and groups with enough permissions for the respective tasks</li>
</ul>
<h2 id="create-an-admin-group">Create an Admin Group<a class="headerlink" href="#create-an-admin-group" title="Permanent link">#</a></h2>
<p>Start by creating an admin group which will later be used as the administrator of our AKS cluster. Log in to <a href="https://portal.azure.com/signin/index/">Azure Portal</a> from CLI:</p>
<div class="highlight"><pre><span></span><code>az login
</code></pre></div>
<div class="highlight"><pre><span></span><code>$ az ad signed-in-user show

{
  &quot;@odata.context&quot;: &quot;https://graph.microsoft.com/v1.0/$metadata#users/$entity&quot;,
  &quot;businessPhones&quot;: [],
  &quot;displayName&quot;: &quot;test-admin-user&quot;,
  &quot;givenName&quot;: null,
  &quot;id&quot;: &quot;&lt;user-id&gt;&quot;,
  &quot;jobTitle&quot;: null,
  &quot;mail&quot;: null,
  &quot;mobilePhone&quot;: null,
  &quot;officeLocation&quot;: null,
  &quot;preferredLanguage&quot;: null,
  &quot;surname&quot;: null,
  &quot;userPrincipalName&quot;: &quot;&lt;upn&gt;&quot;
}
</code></pre></div>
<p>The user-id will be used later to add our user in the admin group for MTO.</p>
<p>Create a group called <code>mto-admins</code>:</p>
<div class="highlight"><pre><span></span><code>az ad group create --display-name mto-admins --mail-nickname mto-admins
</code></pre></div>
<p>Using the above user-id, link user to the newly created group:</p>
<div class="highlight"><pre><span></span><code>az ad group member add --group mto-admins --member-id &lt;user-id&gt;
</code></pre></div>
<p>Use this command to get admin-group-id, this will later be used while provisioning the cluster:</p>
<div class="highlight"><pre><span></span><code>$ az ad group show --group mto-admins

{
  **********
  &quot;description&quot;: null,
  &quot;displayName&quot;: &quot;mto-admins&quot;,
  &quot;expirationDateTime&quot;: null,
  &quot;groupTypes&quot;: [],
  &quot;id&quot;: &quot;&lt;admin-group-id&gt;&quot;,
  &quot;isAssignableToRole&quot;: null,
  **********
}
</code></pre></div>
<h2 id="create-an-aks-cluster">Create an AKS Cluster<a class="headerlink" href="#create-an-aks-cluster" title="Permanent link">#</a></h2>
<p>Create a Resource Group by using the <code>az group create</code> command in your preferred Azure location:</p>
<div class="highlight"><pre><span></span><code>az group create --name myResourceGroup --location westus2
</code></pre></div>
<p>Create a small cluster:</p>
<div class="highlight"><pre><span></span><code>az aks create --resource-group myResourceGroup --name myAKSCluster --node-count 1 --vm-set-type VirtualMachineScaleSets --enable-cluster-autoscaler --min-count 1 --max-count 3 --enable-aad --aad-admin-group-object-ids &lt;admin-group-id&gt;
</code></pre></div>
<h3 id="create-test-groups-in-entra-id">Create test groups in <code>Entra ID</code><a class="headerlink" href="#create-test-groups-in-entra-id" title="Permanent link">#</a></h3>
<p>First, store the ID of your AKS cluster in a variable named AKS_ID:</p>
<div class="highlight"><pre><span></span><code>AKS_ID=$(az aks show --resource-group myResourceGroup --name myAKSCluster --query id -o tsv)
</code></pre></div>
<p>Create your first test group named appdev using group command and assign its ID to APPDEV_ID variable:</p>
<div class="highlight"><pre><span></span><code>APPDEV_ID=$(az ad group create --display-name appdev --mail-nickname appdev --query id -o tsv)
</code></pre></div>
<p>Allow the appdev group to interact with the AKS cluster using kubectl by assigning them the Azure Kubernetes Service Cluster User Role:</p>
<div class="highlight"><pre><span></span><code>az role assignment create --assignee $APPDEV_ID --role &quot;Azure Kubernetes Service Cluster User Role&quot; --scope $AKS_ID
</code></pre></div>
<p>Create your second test group named opssre using the command and assign its ID to the OPSSRE_ID variable:</p>
<div class="highlight"><pre><span></span><code>OPSSRE_ID=$(az ad group create --display-name opssre --mail-nickname opssre --query id -o tsv)
</code></pre></div>
<p>Allow the opssre group to interact with the AKS cluster using kubectl by assigning them the Azure Kubernetes Service Cluster User Role:</p>
<div class="highlight"><pre><span></span><code>az role assignment create --assignee $OPSSRE_ID --role &quot;Azure Kubernetes Service Cluster User Role&quot; --scope $AKS_ID
</code></pre></div>
<h3 id="create-test-users-in-entra-id">Create test users in <code>Entra ID</code><a class="headerlink" href="#create-test-users-in-entra-id" title="Permanent link">#</a></h3>
<p>Set User Principal Name (UPN) and password for your users. The UPN must include the verified domain name of your tenant, for example user@company.com.</p>
<p>Following command reads the UPN for the appdev group and stores it in the AAD_DEV_UPN variable:</p>
<div class="highlight"><pre><span></span><code>echo &quot;Please enter the UPN for application developers: &quot; &amp;&amp; read AAD_DEV_UPN
</code></pre></div>
<p>For this scope of this blog, we will assume that the entered UPN was aksdev@company.com.</p>
<p>Following command reads the password for your user and stores it in the AAD_DEV_PW variable:</p>
<div class="highlight"><pre><span></span><code>echo &quot;Please enter the secure password for application developers: &quot; &amp;&amp; read AAD_DEV_PW
</code></pre></div>
<p>Create the user <code>AKS Dev</code> using the previously created variables:</p>
<div class="highlight"><pre><span></span><code>AKSDEV_ID=$(az ad user create --display-name &quot;AKS Dev&quot; --user-principal-name $AAD_DEV_UPN --password $AAD_DEV_PW --query id -o tsv)
</code></pre></div>
<p>Add this user to the <code>appdev</code> group that was previously created:</p>
<div class="highlight"><pre><span></span><code>az ad group member add --group appdev --member-id $AKSDEV_ID
</code></pre></div>
<p>Repeat the steps for <code>OPS SRE</code> user.</p>
<p>The following command reads the UPN for your user and stores it in the AAD_SRE_UPN variable:</p>
<div class="highlight"><pre><span></span><code>echo &quot;Please enter the UPN for SREs: &quot; &amp;&amp; read AAD_SRE_UPN
</code></pre></div>
<p>For this scope of this blog, we will assume that the entered UPN was opssre@company.com.</p>
<p>The following command reads the password for your user and stores it in the AAD_SRE_PW variable:</p>
<div class="highlight"><pre><span></span><code>echo &quot;Please enter the secure password for SREs: &quot; &amp;&amp; read AAD_SRE_PW
</code></pre></div>
<p>Create the user <code>AKS SRE</code> using above variables</p>
<div class="highlight"><pre><span></span><code>AKSSRE_ID=$(az ad user create --display-name &quot;AKS SRE&quot; --user-principal-name $AAD_SRE_UPN --password $AAD_SRE_PW --query id -o tsv)
</code></pre></div>
<p>Add this user to the <code>opssre</code> group that was previously created:</p>
<div class="highlight"><pre><span></span><code>az ad group member add --group opssre --member-id $AKSSRE_ID
</code></pre></div>
<h2 id="installing-cert-manager-and-mto">Installing Cert Manager and MTO<a class="headerlink" href="#installing-cert-manager-and-mto" title="Permanent link">#</a></h2>
<p>In this section, we will install Multi Tenant Operator (MTO) for tenancy between different users and groups. MTO has several webhooks which need certificates. For automated handling of certs, we will install Cert Manager as a prerequisite.</p>
<p>Start by logging in to Azure from CLI by running the following command:</p>
<div class="highlight"><pre><span></span><code>kubectl get pods
</code></pre></div>
<p>Executing the command will take you to a browser window where you can log in from your test-admin-user.</p>
<p>Running <code>kubectl auth whoami</code> will show you the user info:</p>
<div class="highlight"><pre><span></span><code>$ kubectl auth whoami

ATTRIBUTE    VALUE
Username     test-admin-user
Groups       [&lt;mto-admins-id&gt; system:authenticated]
Extra: oid   [&lt;oid&gt;]
</code></pre></div>
<p>You will notice that the <code>mto-admins</code> group ID is attached with our test-admin-user user. This user will be used for all the cluster admin level operations.</p>
<h3 id="install-cert-manager">Install Cert Manager<a class="headerlink" href="#install-cert-manager" title="Permanent link">#</a></h3>
<p>Install Cert Manager in the cluster for automated handling of operator webhook certs:</p>
<div class="highlight"><pre><span></span><code>kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.14.4/cert-manager.yaml
</code></pre></div>
<p>Let's wait for the pods to be up:</p>
<div class="highlight"><pre><span></span><code>$ kubectl get pods -n cert-manager --watch

NAME                                       READY   STATUS    RESTARTS   AGE
cert-manager-7fb948f468-wgcbx              1/1     Running   0          7m18s
cert-manager-cainjector-75c5fc965c-wxtkp   1/1     Running   0          7m18s
cert-manager-webhook-757c9d4bb7-wd9g8      1/1     Running   0          7m18s
</code></pre></div>
<h3 id="install-mto-using-helm">Install MTO using Helm<a class="headerlink" href="#install-mto-using-helm" title="Permanent link">#</a></h3>
<p>Helm will be used to install MTO as it is the only available way of installing it on Kubernetes Clusters.</p>
<p>Use helm install command to install MTO helm chart. Here, <code>bypassedGroups</code> has to be set as <code>system:masters</code> as it is used by masterclient of AKS and <code>&lt;mto-admins-id&gt;</code>as it is used by test-admin-user:</p>
<div class="highlight"><pre><span></span><code>helm install tenant-operator oci://ghcr.io/stakater/public/charts/multi-tenant-operator --version 0.12.62 --namespace multi-tenant-operator --create-namespace --set bypassedGroups=&#39;system:masters\,&lt;mto-admins-id&gt;&#39;
</code></pre></div>
<p>Wait for the pods to come to a running state:</p>
<div class="highlight"><pre><span></span><code>$ kubectl get pods -n multi-tenant-operator --watch

NAME                                                              READY   STATUS    RESTARTS   AGE
tenant-operator-namespace-controller-768f9459c4-758kb             2/2     Running   0          2m
tenant-operator-pilot-controller-7c96f6589c-d979f                 2/2     Running   0          2m
tenant-operator-resourcesupervisor-controller-566f59d57b-xbkws    2/2     Running   0          2m
tenant-operator-template-quota-intconfig-controller-7fc99462dz6   2/2     Running   0          2m
tenant-operator-templategroupinstance-controller-75cf68c872pljv   2/2     Running   0          2m
tenant-operator-templateinstance-controller-d996b6fd-cx2dz        2/2     Running   0          2m
tenant-operator-tenant-controller-57fb885c84-7ps92                2/2     Running   0          2m
tenant-operator-webhook-5f8f675549-jv9n8                          2/2     Running   0          2m
</code></pre></div>
<p>Setting up Tenant for Users
Start by getting IDs for opssre and appdev groups by running <code>az ad group show</code> command:</p>
<div class="highlight"><pre><span></span><code>$ az ad group show --group appdev

{
  ***********
  &quot;displayName&quot;: &quot;opssre&quot;,
  &quot;expirationDateTime&quot;: null,
  &quot;groupTypes&quot;: [],
  &quot;id&quot;: &quot;&lt;opssre-group-id&gt;&quot;,
  &quot;isAssignableToRole&quot;: null,
  ************
}
</code></pre></div>
<div class="highlight"><pre><span></span><code>$ az ad group show --group appdev

{
  ***********
  &quot;displayName&quot;: &quot;appdev&quot;,
  &quot;expirationDateTime&quot;: null,
  &quot;groupTypes&quot;: [],
  &quot;id&quot;: &quot;&lt;appdev-group-id&gt;&quot;,
  &quot;isAssignableToRole&quot;: null,
  ************
}
</code></pre></div>
<p>Create a <code>Quota CR</code> with some resource limits:</p>
<div class="highlight"><pre><span></span><code>$ kubectl apply -f - &lt;&lt;EOF
apiVersion: tenantoperator.stakater.com/v1beta1
kind: Quota
metadata:
  name: small
spec:
  limitrange:
    limits:
    - max:
        cpu: 800m
      min:
        cpu: 200m
      type: Container
  resourcequota:
    hard:
      configmaps: &quot;10&quot;
EOF
</code></pre></div>
<p>Now, mention this <code>Quota</code> in two <code>Tenant</code> CRs, with opssre and appdev group IDs in the groups section of spec:</p>
<div class="highlight"><pre><span></span><code>$ kubectl apply -f - &lt;&lt;EOF
apiVersion: tenantoperator.stakater.com/v1beta3
kind: Tenant
metadata:
  name: tenant-a
spec:
  namespaces:
    withTenantPrefix:
    - dev
    - build
  accessControl:
    owners:
      groups:
    - &lt;opssre-group-id&gt;
  quota: small
EOF
</code></pre></div>
<div class="highlight"><pre><span></span><code>$ kubectl apply -f - &lt;&lt;EOF
apiVersion: tenantoperator.stakater.com/v1beta3
kind: Tenant
metadata:
  name: tenant-b
spec:
  namespaces:
    withTenantPrefix:
    - dev
    - build
  accessControl:
    owners:
      groups:
    - &lt;appdev-group-id&gt;
  quota: small
EOF
</code></pre></div>
<p>Notice that the only difference in both tenant specs are the groups.</p>
<p>Check if the tenant namespaces have been created:</p>
<div class="highlight"><pre><span></span><code>$ kubectl get namespaces

NAME                    STATUS   AGE
cert-manager            Active   4h26m
default                 Active   5h25m
kube-node-lease         Active   5h25m
kube-public             Active   5h25m
kube-system             Active   5h25m
multi-tenant-operator   Active   3h55m
tenant-a-build          Active   10m
tenant-a-dev            Active   10m
tenant-b-build          Active   10m
tenant-b-dev            Active   10m
</code></pre></div>
<p>Notice that MTO has created two namespaces under each tenant.</p>
<h2 id="users-interaction-with-the-cluster">Users Interaction with the Cluster<a class="headerlink" href="#users-interaction-with-the-cluster" title="Permanent link">#</a></h2>
<h3 id="appdev-group">AppDev group<a class="headerlink" href="#appdev-group" title="Permanent link">#</a></h3>
<p>AppDev is one of the previously created groups, its scope is limited to Tenant A namespaces as we mentioned its group ID in Tenant A. Start by clearing token of test-admin-user:</p>
<div class="highlight"><pre><span></span><code>kubelogin remove-tokens
</code></pre></div>
<p>Use the aksdev user from appdev group to log in to the cluster:</p>
<div class="highlight"><pre><span></span><code>kubectl get pods
</code></pre></div>
<p>This will take you to devicelogin page. After entering the correct code, it will redirect you to Microsoft Login page, here you will enter the email and password of aksdev user created at the start of the article.</p>
<p>After successful log in, it will show you the output of your kubectl command:</p>
<div class="highlight"><pre><span></span><code>Error from server (Forbidden): pods is forbidden: User &quot;aksdev@company.com&quot; cannot list resource &quot;pods&quot; in API group &quot;&quot; in the namespace &quot;default&quot;
</code></pre></div>
<p>This user does not have access to default namespace.</p>
<p>Now try accessing the resources in its tenant namespaces which are under Tenant A:</p>
<div class="highlight"><pre><span></span><code>$ kubectl get pods -n tenant-a-dev

No resources found in tenant-a-dev namespace.
</code></pre></div>
<p>Create an <code>nginx</code> pod in the same namespace</p>
<div class="highlight"><pre><span></span><code>$ kubectl run nginx --image=nginx -n tenant-a-dev

pod/nginx created
</code></pre></div>
<p>Now try the same operation in other namespace of Tenant B:</p>
<div class="highlight"><pre><span></span><code>$ kubectl run nginx --image=nginx -n tenant-b-dev

Error from server (Forbidden): pods is forbidden: User &quot;aksdev@company.com&quot; cannot create resource &quot;pods&quot; in API group &quot;&quot; in the namespace &quot;tenant-b-dev&quot;
</code></pre></div>
<p>This operation fails with an error showing strict controls in their Tenants.</p>
<h3 id="opssre-group">OpsSre group<a class="headerlink" href="#opssre-group" title="Permanent link">#</a></h3>
<p>OpsSre is the second group created at the start of this article, its scope is limited to Tenant B namespaces as we mentioned its group ID in Tenant B.</p>
<p>Start by clearing token of appdev user:</p>
<div class="highlight"><pre><span></span><code>kubelogin remove-tokens
</code></pre></div>
<p>Use the opssre user from opssre group to log in to the cluster:</p>
<div class="highlight"><pre><span></span><code>kubectl get pods
</code></pre></div>
<p>This will take you to devicelogin page. After entering the correct code, it will redirect you to Microsoft Login page, here you will enter the email and password of opssre user created at the start of the article.</p>
<p>After successful log in, it will show you the output of your kubectl command:</p>
<div class="highlight"><pre><span></span><code>Error from server (Forbidden): pods is forbidden: User &quot;opssre@company.com&quot; cannot list resource &quot;pods&quot; in API group &quot;&quot; in the namespace &quot;default&quot;
</code></pre></div>
<p>This user does not have access to default namespace</p>
<p>Now try accessing the resources in its tenant namespaces which are under Tenant B:</p>
<div class="highlight"><pre><span></span><code>$ kubectl get pods -n tenant-b-dev

No resources found in tenant-b-dev namespace.
</code></pre></div>
<p>Create an <code>nginx</code> pod in the same namespace:</p>
<div class="highlight"><pre><span></span><code>$ kubectl run nginx --image=nginx -n tenant-b-dev

pod/nginx created
</code></pre></div>
<p>Now try the same operation in other namespace of Tenant A:</p>
<div class="highlight"><pre><span></span><code>$ kubectl run nginx --image=nginx -n tenant-a-dev

Error from server (Forbidden): pods is forbidden: User &quot;opssre@company.com&quot; cannot create resource &quot;pods&quot; in API group &quot;&quot; in the namespace &quot;tenant-a-dev&quot;
</code></pre></div>
<p>This operation fails with an error showing strict controls in their Tenants.</p>
<h2 id="cleanup-resources">Cleanup Resources<a class="headerlink" href="#cleanup-resources" title="Permanent link">#</a></h2>
<p>Cleanup the users, groups, AKS Cluster and Resource Group created for this blog.
Run the following set of commands to remove resources created in above sections:</p>
<div class="highlight"><pre><span></span><code># Delete the Azure AD user accounts for aksdev and akssre.

$ az ad user delete --id $AKSDEV_ID
$ az ad user delete --id $AKSSRE_ID

# Delete the Azure AD groups for `appdev`,`opssre` and `mto-admins`. This also deletes the Azure role assignments.

$ az ad group delete --group appdev
$ az ad group delete --group opssre
$ az ad group delete --group mto-admins

# Delete the Resource Group which will also delete the underlying AKS test cluster and related resources

$ az group delete --name myResourceGroup
</code></pre></div>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  




<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
      <button type="reset" class="md-button md-button--primary">Reject</button>
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.tracking", "toc.follow", "navigation.top"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>